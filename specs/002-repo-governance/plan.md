# Implementation Plan: Repository & Governance Evolution (Phase 2.0)

**Branch**: `002-repo-governance` | **Date**: 2026-01-01 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/002-repo-governance/spec.md`

## Summary

Phase 2.0 evolves the Phase I repository into a full-stack-ready monorepo by establishing directory structure, specification governance, and Claude Code context layering. This is a governance-only phase with no application code - all deliverables are documentation and configuration files.

## Technical Context

**Language/Version**: N/A (documentation and configuration only)
**Primary Dependencies**: None (governance phase)
**Storage**: N/A
**Testing**: Manual verification (directory existence, file content)
**Target Platform**: Repository structure
**Project Type**: Monorepo (frontend + backend)
**Performance Goals**: N/A
**Constraints**: No application code, Phase I must remain unchanged
**Scale/Scope**: Repository-level changes only

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Gate | Requirement | Status |
|------|-------------|--------|
| Spec-Driven Development | Spec exists before plan | ✅ PASS |
| Phase Discipline | Phase 2.0 scope only | ✅ PASS |
| No Application Code | Governance only | ✅ PASS |
| Technology Stack | No violations | ✅ PASS (no code) |
| Documentation Required | All artifacts produced | ✅ PASS |
| Spec-Kit Authority | All specs in /specs | ✅ PASS |

**No violations** - Phase 2.0 is explicitly governance-focused per specification.

## Project Structure

### Documentation (this feature)

```text
specs/002-repo-governance/
├── spec.md              # Feature specification
├── plan.md              # This file
├── research.md          # Technical decisions
├── data-model.md        # N/A for governance phase
├── quickstart.md        # Verification guide
├── checklists/
│   └── requirements.md  # Quality checklist
└── tasks.md             # Generated by /sp.tasks
```

### Repository Structure (target state)

```text
/
├── CLAUDE.md              # Root context (updated)
├── AGENTS.md              # Behavioral authority (unchanged)
├── frontend/
│   └── CLAUDE.md          # Frontend-specific context
├── backend/
│   └── CLAUDE.md          # Backend-specific context
├── src/                   # Phase I code (PRESERVED)
│   ├── __init__.py
│   ├── main.py
│   ├── task_model.py
│   ├── task_store.py
│   └── cli.py
├── specs/
│   ├── overview.md        # Project overview
│   ├── architecture.md    # System architecture
│   ├── features/          # Feature specs
│   ├── api/               # API specs
│   ├── database/          # Database specs
│   └── ui/                # UI specs
├── .spec-kit/
│   └── config.yaml        # Spec-Kit configuration
├── .specify/              # Existing templates (unchanged)
├── .claude/               # Existing agents/skills (unchanged)
└── history/               # Existing PHRs/ADRs (unchanged)
```

**Structure Decision**: Layer-based monorepo with /frontend, /backend, and preserved /src. Specs organized by concern under /specs.

## Execution Strategy

Phase 2.0 will be executed in 4 phases:

### Phase 1: Spec Governance Setup
1. Create /specs directory structure
2. Create overview.md and architecture.md
3. Create feature subdirectories (features/, api/, database/, ui/)
4. Document @specs/ path convention

### Phase 2: Repository Structure
1. Create /frontend directory with placeholder
2. Create /backend directory with placeholder
3. Verify /src remains unchanged
4. Create /.spec-kit/config.yaml

### Phase 3: Claude Code Context Layering
1. Update root CLAUDE.md with project overview
2. Create /frontend/CLAUDE.md with frontend constraints
3. Create /backend/CLAUDE.md with backend constraints
4. Reference AGENTS.md as behavioral authority

### Phase 4: Validation
1. Verify all directories exist
2. Verify all CLAUDE.md files have required content
3. Verify Phase I code unchanged (git diff)
4. Verify Spec-Kit configuration valid

## CLAUDE.md Content Specifications

### Root CLAUDE.md Content

Must include:
- Project name: "Evolution of Todo"
- Current phase description
- Spec-Kit Plus structure explanation
- Reference to AGENTS.md for behavioral rules
- @specs/ path convention documentation
- Layer directory descriptions (/frontend, /backend)

### Frontend CLAUDE.md Content

Must include:
- Layer identification: "Next.js Frontend with App Router"
- Technology stack: Next.js, React, TypeScript
- Coding conventions for frontend
- **Restriction**: "DO NOT implement backend logic, APIs, database access, or Python code"
- Reference to root CLAUDE.md for project context

### Backend CLAUDE.md Content

Must include:
- Layer identification: "Python FastAPI Backend"
- Technology stack: FastAPI, Python 3.13+, SQLModel
- Coding conventions for backend
- **Restriction**: "DO NOT implement frontend UI, React components, styling, or JavaScript/TypeScript code"
- Reference to root CLAUDE.md for project context

## Spec-Kit Configuration

```yaml
# /.spec-kit/config.yaml
version: "1.0"
specs_directory: "specs"
history_directory: "history"
templates_directory: ".specify/templates"
agent_context: "AGENTS.md"
```

## Responsible Intelligence

| Task | Skill/Agent |
|------|-------------|
| Monorepo structure | monorepo-architecture skill |
| Spec organization | spec-referencing skill |
| CLAUDE.md layering | claude-context-design skill |
| Validation | Manual verification |

## Dependencies

| Dependency | Status |
|------------|--------|
| Phase I complete | ✅ Complete (42 tasks) |
| AGENTS.md exists | ✅ Exists |
| .specify templates exist | ✅ Exists |
| Git repository | ✅ Initialized |

## Risk Mitigation

| Risk | Mitigation |
|------|------------|
| Accidental Phase I modification | Verify via git diff before completion |
| Missing directories | Validation checklist in quickstart.md |
| Invalid CLAUDE.md content | Content specifications documented above |
| Broken @specs/ paths | Document convention in root CLAUDE.md |

## Success Criteria Mapping

| Spec Criterion | Plan Deliverable |
|----------------|------------------|
| SC-001: Directories exist | Phase 2 tasks + validation |
| SC-002: CLAUDE.md files | Phase 3 tasks |
| SC-003: Spec subdirs | Phase 1 tasks |
| SC-004: Phase I unchanged | Phase 4 git diff verification |
| SC-005: Config valid | Phase 2 config creation |
| SC-006: @specs paths | Phase 1 + root CLAUDE.md |

## Next Steps

1. Run `/sp.tasks` to generate implementation task breakdown
2. Execute tasks via `/sp.implement`
3. Verify all success criteria
4. Commit and push to feature branch
5. Proceed to Phase 2.1: Database Persistence Layer
